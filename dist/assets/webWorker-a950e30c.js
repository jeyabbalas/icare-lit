(function(n){"use strict";async function _(){return await n.loadWasmICARE()}async function m(a){const r=["https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/model_formula_lt50.txt","https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/model_formula_ge50.txt","https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/model_log_odds_ratios_lt50.json","https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/model_log_odds_ratios_ge50.json","https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/reference_covariate_data_lt50.csv","https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/reference_covariate_data_ge50.csv","https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/age_specific_breast_cancer_incidence_rates.csv","https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/age_specific_all_cause_mortality_rates.csv"];await a.preloadFiles(r)}(async()=>(self.icare=await _(),self.iCARELitPreloadPromise=await m(self.icare)))();function u(a,r){if(!Array.isArray(a)||!Array.isArray(r))throw new Error("Both headers and data must be arrays.");function t(e){return typeof e=="string"&&(e.includes(",")||e.includes('"')||e.includes(`
`))?`"${e.replace(/"/g,'""')}"`:e}const i=a.map(e=>t(e)).join(","),c=r.map(e=>a.map(s=>{const o=e.hasOwnProperty(s)&&e[s]!==void 0?e[s]:"";return t(o)}).join(",")).join(`
`);return`${i}
${c}`}function b(a){const r=a.age;let t,i=[a];return r>=50?t=["age_at_menarche","parity","age_first_birth","oc_ever","alcohol_intake","bbd","famhist","age_at_menopause","height","hrt","hrt_type","bmi_curc"]:t=["age_at_menarche","parity","age_first_birth","oc_ever","oc_current","alcohol_intake","bbd","famhist","height","bmi_curc"],u(t,i)}self.addEventListener("message",async a=>{await self.iCARELitPreloadPromise;let r=a.data;const t=r.age,i=5,c=t>=50?"https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/model_formula_ge50.txt":"https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/model_formula_lt50.txt",e=t>=50?"https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/model_log_odds_ratios_ge50.json":"https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/model_log_odds_ratios_lt50.json",s=t>=50?"https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/reference_covariate_data_ge50.csv":"https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/reference_covariate_data_lt50.csv",o="https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/age_specific_breast_cancer_incidence_rates.csv",d="https://raw.githubusercontent.com/jeyabbalas/icare-lit/master/icare_lit/age_specific_all_cause_mortality_rates.csv",g=b(r),l="query_covariate_profile.csv";self.icare.pyodide.FS.writeFile(l,g),self.icare.preloadedFiles.push(l);const h={applyAgeStart:t,applyAgeIntervalLength:i,modelCovariateFormulaUrl:c,modelLogRelativeRiskUrl:e,modelReferenceDatasetUrl:s,applyCovariateProfileUrl:l,modelDiseaseIncidenceRatesUrl:o,modelCompetingIncidenceRatesUrl:d,returnReferenceRisks:!0,seed:1234},p=await self.icare.computeAbsoluteRisk(h);self.postMessage(p)})})(wasmIcare_js);
